[project]
dependencies = []
description = "Add a short description here"
name = "geophysical-nav"
requires-python = ">= 3.11"
version = "0.1.0"

[build-system]
# requires = ["setuptools", "wheel", "build", "pybind11"]
# build-backend = "setuptools.build_meta"
requires = ["scikit-build-core", "pybind11"]
build-backend = "scikit_build_core.build"

# [tool.scikit-build]
# build-dir = "src/navtoolbox"
# cmake.verbose = true

# [tool.setuptools]
# package-dir = {"" = "src"}
# packages = ["geophysical", "data_management", "navtoolbox"]

[tool.pytest]
testpaths = ["tests"]
python_files = ["test_*.py", "*_test.py", "tests.py", "test.py"]
python_classes = ["Test*", "*Test"]
python_functions = ["test_*"]

[tool.pytest.ini_options]
pythonpath = "./src"
addopts = ["--import-mode=importlib", "--cov=src", "--cov-report=term-missing"]

[tool.ruff]
line-length = 120

[tool.pixi.project]
channels = ["conda-forge"]
platforms = ["linux-64", "win-64", "osx-64"]

[tool.pixi.pypi-dependencies]
geophysical_nav = { path = ".", editable = true }
python-ins = "*"
anglewrapper = "*"
build = "*"
setuptools = "*"
wheel = "*"

[tool.pixi.dependencies]
numpy = "*"
pandas = "*"
filterpy = "*"
pytz = "*"
haversine = "*"
pygmt = "*"
numba = "*"
matplotlib = "*"
h5py = "*"
sqlalchemy = "*"
sqlite = "*"
tqdm = "*"
pytables = "*"
pybind11 = "*"
pip = "*"
cxx-compiler = "*"
eigen = ">=3.4.0,<4"

[tool.pixi.feature.dev.dependencies]
notebook = "*"
cmake = "*"
make = "*"

[tool.pixi.feature.dev.tasks]
build = {cmd = "rm -r dist; rm -r sdist; rm -r build; python -m build;"}
install = {cmd = "WHL_FILE=$(find ./dist -name '*.whl'); python -m pip install $WHL_FILE --force-reinstall", depends-on="build"}

[tool.pixi.feature.test.dependencies]
pytest = "*"
pytest-cov = "*"
ruff = "*"

[tool.pixi.feature.test.tasks]
lint = "ruff format ."
test = {cmd = "coverage run -m pytest", depends-on = "lint"}

[tool.pixi.environments]
test = { features = ["test"], solve-group = "default" }
dev = { features = ["dev"], solve-group = "default" }
